# PRD: Nacre v3 - Professional Agentic Project Management

## Overview

Nacre is a local-first, agent-centric project management interface designed to sit on top of the [Beads](https://github.com/steveyegge/beads) issue tracking system. It provides a bridge between human developers and coding agents by offering an interactive web interface for visualizing, managing, and analyzing development workflows stored in the Beads git-backed database.

## Goals

1.  **Unified Context**: Provide a shared visual language for humans and agents to understand project state.
2.  **Workflow Transparency**: Expose hierarchical task structures and dependencies that are often hidden in flat lists.
3.  **Data-Driven Insights**: Deliver professional-grade development metrics (DORA-lite) to identify bottlenecks.
4.  **Interaction Efficiency**: Minimize friction through keyboard-first navigation and inline editing.
5.  **Aesthetic Excellence**: Offer a polished, Scandinavian-minimalist UI that supports both light and dark themes.

## Job Stories

- **As a technical project manager**, I can visualize my task hierarchy, so that I understand the relationships between high-level epics and granular sub-tasks.
- **As a developer**, I can manage my daily work on a Kanban board, so that I have a clear view of current priorities and progress.
- **As a technical project manager**, I can track my cycle time and throughput, so that I can improve my team's predictability and efficiency.
- **As a developer**, I can navigate the interface primarily using my keyboard, so that I can maintain my flow state.

## Assumptions

1.  The `bd` (Beads) CLI binary is available in the system path or specified via environment variables.
2.  The project follows the Beads directory structure (`.beads/` directory).
3.  Users prefer a local-first experience with no external authentication required.

## Functional Requirements

### FR-1: Hierarchical Task Management

- **Requirement**: The system must display issues in a nested tree structure.
- **Acceptance**:
  - Support for implicit parent-child relationships via dot-notation (e.g., `nacre-1.1`).
  - Support for explicit `ParentChild` dependency types.
  - Interactive expand/collapse controls (All, Level-by-Level, Single Node).
  - Visual indicators for blocked status based on non-parent dependencies.

### FR-2: Professional Kanban Board

- **Requirement**: A drag-and-drop interface for managing issue status.
- **Acceptance**:
  - Columns mapped to Beads status: Open, In Progress, Blocked, Deferred, Closed.
  - Drag-and-drop cards between columns triggers backend status updates.
  - Toggleable column visibility (e.g., hide "Deferred" by default).
  - Filtering by issue type (Epic, Feature, Bug, etc.) within the board.

### FR-3: Development Metrics (Analytics)

- **Requirement**: Automated calculation of key performance indicators.
- **Acceptance**:
  - **Lead Time**: Time from creation to closure.
  - **Cycle Time**: Time spent in the "In Progress" status (derived from activity logs).
  - **Throughput**: Number of issues closed per day.
  - **Velocity**: Issues closed in the last 7 days.
  - **Percentiles**: p50, p90, and p100 calculations for lead and cycle times.
  - Visual bar charts for activity, lead time, cycle time, and throughput.

### FR-4: Documentation (PRD) Browser

- **Requirement**: Integrated reading experience for product requirement documents.
- **Acceptance**:
  - List all Markdown files in `docs/prds/`.
  - Render Markdown content to clean, readable HTML with syntax highlighting and styling.

### FR-5: Fast Interactive Search & Filtering

- **Requirement**: Global real-time filtering of issues.
- **Acceptance**:
  - "Search-as-you-type" functionality across Task List, Board, and Graph views.
  - Filtering by text (Title/ID) and metadata (Type/Status).

### FR-6: Inline Editing

- **Requirement**: Quick modification of issue titles.
- **Acceptance**:
  - Clicking a title in the Task List enables an input field.
  - Saving (Enter/Blur) persists the change via API.

### FR-7: Persistent Theming

- **Requirement**: High-contrast Dark and Light themes.
- **Acceptance**:
  - Manual toggle and auto-detection of system preference.
  - State persistence in `localStorage`.

### FR-8: Keyboard Navigation (Power User Mode)

- **Requirement**: Vim-like navigation across views.
- **Acceptance**:
  - `j`/`k` for vertical movement in lists and columns.
  - `h`/`l` for horizontal movement between Kanban columns.
  - `Enter`/`o` to open details.
  - `Backspace` to navigate back.

## Non-functional Requirements

- **NFR-1: Performance**: Initial page load and navigation transitions should feel instantaneous (<100ms for local data).
- **NFR-2: Tech Stack Adherence**:
  - Backend: Rust (Axum, Askama).
  - Frontend: Vanilla TypeScript (Modern ESM, bundled with Bun).
  - Data: CLI-based interaction with Beads `bd`.
- **NFR-3: Zero-Config**: The application should discover the current project context automatically.

## Non-Goals

- Multi-user authentication or role-based access control.
- Direct git commit/push integration (handled by Beads CLI).
- Built-in rich text editor for descriptions (currently Markdown-based textareas).

## Success Metrics

1.  **Feature Parity**: 100% of Beads core issue types and statuses supported in UI.
2.  **User Efficiency**: >80% of common management tasks (status update, title edit) can be done in <3 seconds.
3.  **System Reliability**: Zero data loss during status transitions or title edits.
