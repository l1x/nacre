<!DOCTYPE html>
<html lang="en">
<head>
    {% include "_head.html" %}
</head>
<body>
    {% include "_header.html" %}
    <main id="content">
        <div class="metrics-container">
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Avg Lead Time</h3>
                    <div class="metric-value">{{ avg_lead_time_hours|format_hours }}</div>
                    <div class="metric-label">Time from creation to close</div>
                </div>
                <div class="metric-card">
                    <h3>Avg Cycle Time</h3>
                    <div class="metric-value">{{ avg_cycle_time_mins|format_minutes }}</div>
                    <div class="metric-label">Time spent in progress</div>
                </div>
                <div class="metric-card">
                    <h3>Throughput</h3>
                    <div class="metric-value">{{ throughput_per_day|format_decimal }}</div>
                    <div class="metric-label">Issues closed per day (last 7d)</div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Velocity</h3>
                    <div class="metric-value">{{ closed_last_7_days }}</div>
                    <div class="metric-label">Issues closed in last 7 days</div>
                </div>
                <div class="metric-card">
                    <h3>WIP</h3>
                    <div class="metric-value">{{ wip_count }}</div>
                    <div class="metric-label">Issues currently in progress</div>
                </div>
                <div class="metric-card">
                    <h3>Blocked</h3>
                    <div class="metric-value">{{ blocked_count }}</div>
                    <div class="metric-label">Issues currently blocked</div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>p50 Lead Time</h3>
                    <div class="metric-value">{{ p50_lead_time_hours|format_hours }}</div>
                    <div class="metric-label">Median lead time</div>
                </div>
                <div class="metric-card">
                    <h3>p90 Lead Time</h3>
                    <div class="metric-value">{{ p90_lead_time_hours|format_hours }}</div>
                    <div class="metric-label">90th percentile</div>
                </div>
                <div class="metric-card">
                    <h3>p100 Lead Time</h3>
                    <div class="metric-value">{{ p100_lead_time_hours|format_hours }}</div>
                    <div class="metric-label">Maximum lead time</div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>p50 Cycle Time</h3>
                    <div class="metric-value">{{ p50_cycle_time_mins|format_minutes }}</div>
                    <div class="metric-label">Median cycle time</div>
                </div>
                <div class="metric-card">
                    <h3>p90 Cycle Time</h3>
                    <div class="metric-value">{{ p90_cycle_time_mins|format_minutes }}</div>
                    <div class="metric-label">90th percentile</div>
                </div>
                <div class="metric-card">
                    <h3>p100 Cycle Time</h3>
                    <div class="metric-value">{{ p100_cycle_time_mins|format_minutes }}</div>
                    <div class="metric-label">Maximum cycle time</div>
                </div>
            </div>

            <section class="metrics-section" id="ticket-activity">
                <h2>Ticket Activity</h2>
                <div class="chart-container">
                    {{ tickets_chart_svg|safe }}
                </div>
            </section>

            {% if !lead_time_chart_svg.is_empty() %}
            <section class="metrics-section" id="lead-time">
                <h2>Lead Time</h2>
                <div class="chart-container">
                    {{ lead_time_chart_svg|safe }}
                </div>
            </section>
            {% endif %}

            {% if !cycle_time_distribution_svg.is_empty() %}
            <section class="metrics-section" id="cycle-time">
                <h2>Cycle Time</h2>
                <div class="chart-container">
                    {{ cycle_time_distribution_svg|safe }}
                </div>
            </section>
            {% endif %}

            {% if !throughput_distribution_svg.is_empty() %}
            <section class="metrics-section" id="throughput">
                <h2>Throughput</h2>
                <div class="chart-container">
                    {{ throughput_distribution_svg|safe }}
                </div>
            </section>
            {% endif %}
        </div>
    </main>
{% include "_footer.html" %}
</body>
</html>
